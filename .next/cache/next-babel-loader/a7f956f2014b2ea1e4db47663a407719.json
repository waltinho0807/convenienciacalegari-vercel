{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\walter\\\\Desktop\\\\shoponix-mern-next-ecommerce-store\\\\shoponix\\\\pages\\\\cart.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { parseCookies } from 'nookies';\nimport axios from 'axios';\nimport cookie from 'js-cookie';\nimport { Segment } from 'semantic-ui-react';\nimport CartItemList from \"../components/Cart/CartItemList\";\nimport CartSummary from \"../components/Cart/CartSummary\";\nimport baseUrl from '../utils/baseUrl';\nimport catchErrors from '../utils/catchErrors';\n\nvar Cart = function Cart(_ref) {\n  _s();\n\n  var products = _ref.products,\n      user = _ref.user;\n\n  // console.log(products)\n  var _React$useState = React.useState(products),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      cartProducts = _React$useState2[0],\n      setCartProducts = _React$useState2[1];\n\n  var _React$useState3 = React.useState(false),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      success = _React$useState4[0],\n      setSuccess = _React$useState4[1];\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      loading = _React$useState6[0],\n      setLoading = _React$useState6[1];\n\n  var handleRemoveFromCart = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(productId) {\n      var url, token, payload, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              url = \"\".concat(baseUrl, \"/api/cart\");\n              token = cookie.get(\"token\");\n              payload = {\n                params: {\n                  productId: productId\n                },\n                headers: {\n                  Authorization: token\n                }\n              };\n              _context.next = 5;\n              return axios[\"delete\"](url, payload);\n\n            case 5:\n              response = _context.sent;\n              setCartProducts(response.data);\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleRemoveFromCart(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleCheckout = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(paymentData) {\n      var url, token, payload, headers;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              setLoading(true);\n              url = \"\".concat(baseUrl, \"/api/checkout\");\n              token = cookie.get(\"token\");\n              payload = {\n                paymentData: paymentData\n              };\n              headers = {\n                headers: {\n                  Authorization: token\n                }\n              };\n              _context2.next = 8;\n              return axios.post(url, payload, headers);\n\n            case 8:\n              setSuccess(true);\n              _context2.next = 14;\n              break;\n\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](0);\n              catchErrors(_context2.t0, window.alert);\n\n            case 14:\n              _context2.prev = 14;\n              setLoading(false);\n              return _context2.finish(14);\n\n            case 17:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 11, 14, 17]]);\n    }));\n\n    return function handleCheckout(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    className: \"cart-area\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 9\n    }\n  }, __jsx(Segment, {\n    loading: loading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 13\n    }\n  }, __jsx(CartItemList, {\n    handleRemoveFromCart: handleRemoveFromCart,\n    user: user,\n    products: cartProducts,\n    success: success,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 17\n    }\n  }), __jsx(CartSummary, {\n    handleCheckout: handleCheckout,\n    products: cartProducts,\n    success: success,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 17\n    }\n  })));\n};\n\n_s(Cart, \"glxl5fGi2KJFh5bppbNZz2p3v8E=\");\n\n_c = Cart;\n\nCart.getInitialProps = /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(ctx) {\n    var _parseCookies, token, url, payload, response;\n\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _parseCookies = parseCookies(ctx), token = _parseCookies.token;\n\n            if (token) {\n              _context3.next = 3;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", {\n              products: []\n            });\n\n          case 3:\n            url = \"\".concat(baseUrl, \"/api/cart\");\n            payload = {\n              headers: {\n                Authorization: token\n              }\n            };\n            _context3.next = 7;\n            return axios.get(url, payload);\n\n          case 7:\n            response = _context3.sent;\n            return _context3.abrupt(\"return\", {\n              products: response.data\n            });\n\n          case 9:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function (_x3) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\nexport default Cart;\n\nvar _c;\n\n$RefreshReg$(_c, \"Cart\");","map":{"version":3,"sources":["C:/Users/walter/Desktop/shoponix-mern-next-ecommerce-store/shoponix/pages/cart.js"],"names":["React","parseCookies","axios","cookie","Segment","CartItemList","CartSummary","baseUrl","catchErrors","Cart","products","user","useState","cartProducts","setCartProducts","success","setSuccess","loading","setLoading","handleRemoveFromCart","productId","url","token","get","payload","params","headers","Authorization","response","data","handleCheckout","paymentData","post","window","alert","getInitialProps","ctx"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { parseCookies } from 'nookies';\nimport axios from 'axios';\nimport cookie from 'js-cookie';\nimport { Segment } from 'semantic-ui-react';\nimport CartItemList from \"../components/Cart/CartItemList\"\nimport CartSummary from \"../components/Cart/CartSummary\"\nimport baseUrl from '../utils/baseUrl';\nimport catchErrors from '../utils/catchErrors';\n\nconst Cart = ({ products, user }) => {\n    // console.log(products)\n    const [cartProducts, setCartProducts] = React.useState(products);\n    const [success, setSuccess] = React.useState(false);\n    const [loading, setLoading] = React.useState(false);\n\n    const handleRemoveFromCart = async (productId) => {\n        const url = `${baseUrl}/api/cart`;\n        const token = cookie.get(\"token\");\n        const payload = {\n            params: {productId},\n            headers: {Authorization: token}\n        };\n        const response = await axios.delete(url, payload);\n        setCartProducts(response.data);\n    }\n\n    const handleCheckout = async (paymentData) => {\n        try {\n            setLoading(true);\n            const url = `${baseUrl}/api/checkout`;\n            const token = cookie.get(\"token\");\n            const payload = { paymentData };\n            const headers = {headers: {Authorization: token}};\n            await axios.post(url, payload, headers);\n            setSuccess(true);\n        } catch (error) {\n            catchErrors(error, window.alert);\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    return (\n        <div className=\"cart-area\">\n            <Segment loading={loading}>\n                <CartItemList \n                    handleRemoveFromCart={handleRemoveFromCart}\n                    user={user} \n                    products={cartProducts} \n                    success={success}\n                />\n                <CartSummary \n                    handleCheckout={handleCheckout}\n                    products={cartProducts} \n                    success={success}\n                />\n            </Segment>\n        </div>\n    );\n}\n\nCart.getInitialProps = async ctx => {\n    const { token } = parseCookies(ctx);\n    if (!token){\n        return { products: [] };\n    }\n    const url = `${baseUrl}/api/cart`;\n    const payload = { headers: {Authorization: token} };\n    const response = await axios.get(url, payload);\n    return { products: response.data };\n}\n\nexport default Cart;"]},"metadata":{},"sourceType":"module"}