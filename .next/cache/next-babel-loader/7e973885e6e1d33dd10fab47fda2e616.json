{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\User\\\\Documents\\\\convenienciacalegari-vercel\\\\pages\\\\cart.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport { parseCookies } from 'nookies';\nimport axios from 'axios';\nimport cookie from 'js-cookie';\nimport { Segment, Divider, Form, Button, Input, Checkbox } from 'semantic-ui-react';\nimport CartItemList from \"../components/Cart/CartItemList\";\nimport baseUrl from '../utils/baseUrl';\nimport catchErrors from '../utils/catchErrors';\nimport calculateCartTotal from '../utils/calculateCartTotal';\nvar INITIAL_ORDER = {\n  phone: \"\",\n  forma: \"\",\n  troco: \"\",\n  address: \"\",\n  bairro: \"\",\n  numero: \"\"\n};\nvar options = [{\n  key: 'cartao',\n  text: 'CARTÃO',\n  value: 'cartao'\n}, {\n  key: 'dinheiro',\n  text: 'DINHEIRO',\n  value: 'dinheiro'\n}];\n\nvar Cart = function Cart(_ref) {\n  _s();\n\n  var products = _ref.products,\n      user = _ref.user;\n  console.log(products);\n\n  var _React$useState = React.useState(products),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      cartProducts = _React$useState2[0],\n      setCartProducts = _React$useState2[1];\n\n  var _React$useState3 = React.useState(false),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      success = _React$useState4[0],\n      setSuccess = _React$useState4[1];\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      loading = _React$useState6[0],\n      setLoading = _React$useState6[1];\n\n  var _React$useState7 = React.useState(0),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      cartAmout = _React$useState8[0],\n      setCartAmaount = _React$useState8[1];\n\n  var _React$useState9 = React.useState(INITIAL_ORDER),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      order = _React$useState10[0],\n      setOrder = _React$useState10[1];\n\n  var _React$useState11 = React.useState(false),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      isCartEmpty = _React$useState12[0],\n      setCartEmpty = _React$useState12[1];\n\n  React.useEffect(function () {\n    var _calculateCartTotal = calculateCartTotal(products),\n        cartTotal = _calculateCartTotal.cartTotal;\n\n    setCartAmaount(cartTotal);\n    setCartEmpty(products.length === 0);\n  }, [products]);\n\n  var handleChanhe = function handleChanhe(e) {\n    // console.log(d.value)\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value;\n\n    if (name === 'media') {\n      setOrder(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, {\n          media: files[0]\n        });\n      });\n      setMediaPreview(window.URL.createObjectURL(files[0]));\n    } else {\n      setOrder(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, name, value));\n      });\n    } //console.log(order);\n\n  };\n\n  var handleSelectInput = function handleSelectInput(e, d) {\n    setOrder(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        forma: d.value\n      });\n    });\n  };\n\n  var handleRemoveFromCart = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(productId) {\n      var url, token, payload, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              url = \"\".concat(baseUrl, \"/api/cart\");\n              token = cookie.get(\"token\");\n              payload = {\n                params: {\n                  productId: productId\n                },\n                headers: {\n                  Authorization: token\n                }\n              };\n              _context.next = 5;\n              return axios[\"delete\"](url, payload);\n\n            case 5:\n              response = _context.sent;\n              setCartProducts(response.data);\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleRemoveFromCart(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleCheckout = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n      var url, token, phone, forma, troco, address, numero, bairro, payload, headers;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              e.preventDefault();\n              _context2.prev = 1;\n              setLoading(true);\n              url = \"\".concat(baseUrl, \"/api/checkout\");\n              token = cookie.get(\"token\");\n              phone = order.phone, forma = order.forma, troco = order.troco, address = order.address, numero = order.numero, bairro = order.bairro;\n              payload = {\n                phone: phone,\n                forma: forma,\n                troco: troco,\n                address: address,\n                numero: numero,\n                bairro: bairro\n              };\n              headers = {\n                headers: {\n                  Authorization: token\n                }\n              };\n              _context2.next = 10;\n              return axios.post(url, payload, headers);\n\n            case 10:\n              setOrder(INITIAL_ORDER);\n              setSuccess(true);\n              _context2.next = 18;\n              break;\n\n            case 14:\n              _context2.prev = 14;\n              _context2.t0 = _context2[\"catch\"](1);\n              catchErrors(_context2.t0, window.alert);\n              console.log(order);\n\n            case 18:\n              _context2.prev = 18;\n              setLoading(false);\n              return _context2.finish(18);\n\n            case 21:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 14, 18, 21]]);\n    }));\n\n    return function handleCheckout(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    className: \"cart-area\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, __jsx(Segment, {\n    loading: loading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, __jsx(CartItemList, {\n    handleRemoveFromCart: handleRemoveFromCart,\n    user: user,\n    products: cartProducts,\n    success: success,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 17\n    }\n  }), __jsx(React.Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 17\n    }\n  }, __jsx(Divider, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 21\n    }\n  }), __jsx(Segment, {\n    clearing: true,\n    size: \"large\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 21\n    }\n  }, __jsx(\"strong\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 25\n    }\n  }, \"Sub total:\"), \" R$\", cartAmout, __jsx(Form, {\n    success: success,\n    onSubmit: handleCheckout,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Input, {\n    fluid: true,\n    icon: \"phone\",\n    iconPosition: \"left\",\n    label: \"Telefone\",\n    placeholder: \"Tel\",\n    name: \"phone\",\n    type: \"text\",\n    value: order.phone,\n    onChange: handleChanhe,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 29\n    }\n  }), __jsx(Form.Input, {\n    fluid: true,\n    icon: \"shipping\",\n    iconPosition: \"left\",\n    label: \"Rua\",\n    placeholder: \"Rua\",\n    name: \"address\",\n    type: \"text\",\n    value: order.address,\n    onChange: handleChanhe,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 29\n    }\n  }), __jsx(Form.Group, {\n    widths: \"equal\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 29\n    }\n  }, __jsx(Form.Input, {\n    fluid: true,\n    icon: \"shipping\",\n    iconPosition: \"left\",\n    label: \"Bairro\",\n    placeholder: \"Bairro\",\n    name: \"bairro\",\n    type: \"text\",\n    value: order.bairro,\n    onChange: handleChanhe,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 33\n    }\n  }), __jsx(Form.Input, {\n    fluid: true,\n    label: \"Numero\",\n    placeholder: \" N\\xBA\",\n    name: \"numero\",\n    type: \"number\",\n    value: order.numero,\n    onChange: handleChanhe,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 33\n    }\n  })), __jsx(Form.Group, {\n    widths: \"equal\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 29\n    }\n  }, __jsx(Form.Select, {\n    name: \"forma\",\n    label: \"Forma de Pagamento\",\n    options: options,\n    placeholder: \"Como Pagar\",\n    onChange: handleSelectInput,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 33\n    }\n  }), __jsx(Form.Field, {\n    control: Input,\n    name: \"troco\",\n    label: \"* Troco para quanto?\",\n    placeholder: \"Somente se dinheiro\",\n    min: \"0.00\",\n    step: \"0.01\",\n    type: \"number\",\n    onChange: handleChanhe,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 33\n    }\n  })), __jsx(Form.Field, {\n    control: Button,\n    type: \"submit\",\n    icon: \"cart\",\n    color: \"green\",\n    floated: \"right\",\n    content: \"Checkout\",\n    disabled: isCartEmpty || success,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 29\n    }\n  }))))));\n};\n\n_s(Cart, \"6FFAzIdXs2J8fkt8oS8FY1BtJCU=\");\n\n_c = Cart;\n\nCart.getInitialProps = /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(ctx) {\n    var _parseCookies, token, url, payload, response;\n\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _parseCookies = parseCookies(ctx), token = _parseCookies.token;\n\n            if (token) {\n              _context3.next = 3;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", {\n              products: []\n            });\n\n          case 3:\n            url = \"\".concat(baseUrl, \"/api/cart\");\n            payload = {\n              headers: {\n                Authorization: token\n              }\n            };\n            _context3.next = 7;\n            return axios.get(url, payload);\n\n          case 7:\n            response = _context3.sent;\n            return _context3.abrupt(\"return\", {\n              products: response.data\n            });\n\n          case 9:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function (_x3) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\nexport default Cart;\n\nvar _c;\n\n$RefreshReg$(_c, \"Cart\");","map":{"version":3,"sources":["C:/Users/User/Documents/convenienciacalegari-vercel/pages/cart.js"],"names":["React","parseCookies","axios","cookie","Segment","Divider","Form","Button","Input","Checkbox","CartItemList","baseUrl","catchErrors","calculateCartTotal","INITIAL_ORDER","phone","forma","troco","address","bairro","numero","options","key","text","value","Cart","products","user","console","log","useState","cartProducts","setCartProducts","success","setSuccess","loading","setLoading","cartAmout","setCartAmaount","order","setOrder","isCartEmpty","setCartEmpty","useEffect","cartTotal","length","handleChanhe","e","target","name","prevState","media","files","setMediaPreview","window","URL","createObjectURL","handleSelectInput","d","handleRemoveFromCart","productId","url","token","get","payload","params","headers","Authorization","response","data","handleCheckout","preventDefault","post","alert","getInitialProps","ctx"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { parseCookies } from 'nookies';\r\nimport axios from 'axios';\r\nimport cookie from 'js-cookie';\r\nimport { Segment, Divider, Form, Button, Input, Checkbox } from 'semantic-ui-react';\r\nimport CartItemList from \"../components/Cart/CartItemList\"\r\nimport baseUrl from '../utils/baseUrl';\r\nimport catchErrors from '../utils/catchErrors';\r\nimport calculateCartTotal from '../utils/calculateCartTotal';\r\n\r\nconst INITIAL_ORDER = {\r\n    phone: \"\",\r\n    forma: \"\",\r\n    troco: \"\",\r\n    address: \"\",\r\n    bairro: \"\",\r\n    numero: \"\"\r\n};\r\n\r\nconst options = [\r\n    { key: 'cartao', text: 'CARTÃO', value: 'cartao' },\r\n    { key: 'dinheiro', text: 'DINHEIRO', value: 'dinheiro' },\r\n\r\n]\r\n\r\nconst Cart = ({ products, user }) => {\r\n    console.log(products)\r\n    const [cartProducts, setCartProducts] = React.useState(products);\r\n    const [success, setSuccess] = React.useState(false);\r\n    const [loading, setLoading] = React.useState(false);\r\n\r\n    const [cartAmout, setCartAmaount] = React.useState(0);\r\n    const [order, setOrder] = React.useState(INITIAL_ORDER);\r\n    const [isCartEmpty, setCartEmpty] = React.useState(false);\r\n\r\n    React.useEffect(() => {\r\n        const { cartTotal } = calculateCartTotal(products);\r\n        setCartAmaount(cartTotal);\r\n        setCartEmpty(products.length === 0)\r\n    }, [products]);\r\n\r\n    const handleChanhe = e => {\r\n        // console.log(d.value)\r\n        const { name, value } = e.target;\r\n        if (name === 'media') {\r\n            setOrder(prevState => ({ ...prevState, media: files[0] }))\r\n            setMediaPreview(window.URL.createObjectURL(files[0]));\r\n        } else {\r\n            setOrder(prevState => ({ ...prevState, [name]: value }));\r\n        }\r\n        //console.log(order);\r\n    }\r\n    const handleSelectInput = (e, d) => {\r\n        setOrder(prevState => ({ ...prevState, forma: d.value }));\r\n    }\r\n\r\n    const handleRemoveFromCart = async (productId) => {\r\n        const url = `${baseUrl}/api/cart`;\r\n        const token = cookie.get(\"token\");\r\n        const payload = {\r\n            params: { productId },\r\n            headers: { Authorization: token }\r\n        };\r\n        const response = await axios.delete(url, payload);\r\n        setCartProducts(response.data);\r\n    }\r\n\r\n    const handleCheckout = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            setLoading(true);\r\n            const url = `${baseUrl}/api/checkout`;\r\n            const token = cookie.get(\"token\");\r\n            const { phone, forma, troco, address, numero, bairro } = order;\r\n            const payload = { phone, forma, troco, address, numero, bairro };\r\n            const headers = { headers: { Authorization: token } };\r\n            await axios.post(url, payload, headers);\r\n            setOrder(INITIAL_ORDER);\r\n            setSuccess(true);\r\n        } catch (error) {\r\n            catchErrors(error, window.alert);\r\n            console.log(order)\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"cart-area\">\r\n            <Segment loading={loading}>\r\n                <CartItemList\r\n                    handleRemoveFromCart={handleRemoveFromCart}\r\n                    user={user}\r\n                    products={cartProducts}\r\n                    success={success}\r\n                />\r\n                <React.Fragment>\r\n                    <Divider />\r\n                    <Segment clearing size=\"large\" >\r\n                        <strong>Sub total:</strong> R${cartAmout}\r\n                        <Form success={success} onSubmit={handleCheckout}>\r\n                            <Form.Input\r\n                                fluid\r\n                                icon=\"phone\"\r\n                                iconPosition=\"left\"\r\n                                label=\"Telefone\"\r\n                                placeholder=\"Tel\"\r\n                                name=\"phone\"\r\n                                type=\"text\"\r\n                                value={order.phone}\r\n                                onChange={handleChanhe}\r\n                            />\r\n\r\n                            <Form.Input\r\n                                fluid\r\n                                icon=\"shipping\"\r\n                                iconPosition=\"left\"\r\n                                label=\"Rua\"\r\n                                placeholder=\"Rua\"\r\n                                name=\"address\"\r\n                                type=\"text\"\r\n                                value={order.address}\r\n                                onChange={handleChanhe}\r\n                            />\r\n\r\n                            <Form.Group widths=\"equal\">\r\n                                <Form.Input\r\n                                    fluid\r\n                                    icon=\"shipping\"\r\n                                    iconPosition=\"left\"\r\n                                    label=\"Bairro\"\r\n                                    placeholder=\"Bairro\"\r\n                                    name=\"bairro\"\r\n                                    type=\"text\"\r\n                                    value={order.bairro}\r\n                                    onChange={handleChanhe}\r\n                                />\r\n                                <Form.Input\r\n                                    fluid\r\n                                    label=\"Numero\"\r\n                                    placeholder=\" Nº\"\r\n                                    name=\"numero\"\r\n                                    type=\"number\"\r\n                                    value={order.numero}\r\n                                    onChange={handleChanhe}\r\n                                />\r\n                            </Form.Group>\r\n\r\n\r\n\r\n                            <Form.Group widths=\"equal\">\r\n                                <Form.Select\r\n                                    name=\"forma\"\r\n                                    label='Forma de Pagamento'\r\n                                    options={options}\r\n                                    placeholder='Como Pagar'\r\n                                    onChange={handleSelectInput}\r\n                                />\r\n                                <Form.Field\r\n                                    control={Input}\r\n                                    name=\"troco\"\r\n                                    label=\"* Troco para quanto?\"\r\n                                    placeholder=\"Somente se dinheiro\"\r\n                                    min=\"0.00\"\r\n                                    step=\"0.01\"\r\n                                    type=\"number\"\r\n                                    onChange={handleChanhe}\r\n                                />\r\n                            </Form.Group>\r\n                            <Form.Field\r\n                                control={Button}\r\n                                type=\"submit\"\r\n                                icon=\"cart\"\r\n                                color=\"green\"\r\n                                floated=\"right\"\r\n                                content=\"Checkout\"\r\n                                disabled={isCartEmpty || success}\r\n                            />\r\n                        </Form>\r\n                    </Segment>\r\n\r\n                </React.Fragment>\r\n            </Segment>\r\n        </div>\r\n    );\r\n}\r\n\r\nCart.getInitialProps = async ctx => {\r\n    const { token } = parseCookies(ctx);\r\n    if (!token) {\r\n        return { products: [] };\r\n    }\r\n    const url = `${baseUrl}/api/cart`;\r\n    const payload = { headers: { Authorization: token } };\r\n    const response = await axios.get(url, payload);\r\n    return { products: response.data };\r\n}\r\n\r\nexport default Cart;"]},"metadata":{},"sourceType":"module"}