{"ast":null,"code":"import jwt from 'jsonwebtoken';\nimport Order from '../../models/Order';\nimport connectDb from '../../utils/connectDb';\nconnectDb();\nexport default (async (req, res) => {\n  switch (req.method) {\n    case \"GET\":\n      await handleGetRequest(req, res);\n      break;\n\n    case \"PUT\":\n      await handlePutRequest(req, res);\n      break;\n\n    default:\n      res.status(405).send(`Method ${req.method} not allowed`);\n      break;\n  }\n});\n\nconst handleGetRequest = async (req, res) => {\n  try {\n    const {\n      userId\n    } = jwt.verify(req.headers.authorization, process.env.JWT_SECRET);\n    const orders = await Order.find({\n      user: userId\n    }).sort({\n      createdAt: 'desc'\n    }).populate({\n      path: \"products.product\",\n      model: \"Product\"\n    });\n    res.status(200).json({\n      orders\n    });\n  } catch (error) {\n    // console.error(error);\n    res.status(403).send(\"Please login\");\n  }\n};\n\nconst handlePutRequest = async (req, res) => {\n  const {\n    _id,\n    status\n  } = req.body;\n  await Order.findOneAndUpdate({\n    _id\n  }, {\n    status\n  });\n  res.status(203).send('Order Updated');\n};","map":null,"metadata":{},"sourceType":"module"}