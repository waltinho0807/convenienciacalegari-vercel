{"ast":null,"code":"var __jsx = React.createElement;\nimport React from 'react';\nimport { Input } from \"semantic-ui-react\";\nimport { useRouter } from 'next/router';\nimport axios from 'axios';\nimport cookie from 'js-cookie';\nimport baseUrl from '../../utils/baseUrl';\nimport catchErrors from '../../utils/catchErrors';\n\nconst AddProductToCart = ({\n  user,\n  productId\n}) => {\n  const [quantity, setQuantity] = React.useState(1);\n  const [loading, setLoading] = React.useState(false);\n  const [success, setSuccess] = React.useState(false);\n  const router = useRouter();\n  React.useEffect(() => {\n    let timeout;\n\n    if (success) {\n      timeout = setTimeout(() => {\n        setSuccess(false);\n      }, 3000);\n    }\n\n    return () => {\n      clearTimeout(timeout);\n    };\n  }, [success]);\n\n  const handleAddProductToCart = async () => {\n    try {\n      setLoading(true);\n      const url = `${baseUrl}/api/cart`;\n      const payload = {\n        quantity,\n        productId\n      };\n      const token = cookie.get('token');\n      const headers = {\n        headers: {\n          Authorization: token\n        }\n      };\n      await axios.put(url, payload, headers);\n      setSuccess(true);\n    } catch (error) {\n      catchErrors(error, window.alert);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Input, {\n    type: \"number\",\n    min: \"1\",\n    max: \"10\",\n    placeholder: \"Quantity\",\n    value: quantity,\n    onChange: e => setQuantity(Number(e.target.value)),\n    action: user && success ? {\n      color: 'blue',\n      content: 'Item Added!',\n      icon: 'plus cart',\n      disabled: true\n    } : user ? {\n      color: 'violet',\n      content: 'Add to Cart',\n      icon: 'plus cart',\n      loading: loading,\n      disbaled: `${loading}`,\n      onClick: handleAddProductToCart\n    } : {\n      color: 'green',\n      content: 'Login to purchase',\n      icon: 'sign-in',\n      onClick: () => router.push('/auth/login')\n    }\n  }));\n};\n\nexport default AddProductToCart;","map":null,"metadata":{},"sourceType":"module"}